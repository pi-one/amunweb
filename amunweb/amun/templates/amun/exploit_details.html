{% extends "base.html" %}

{% block content %}

<br/>

<div class="panel panel-default">
        <div class="panel-heading">
            <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                    <span class="glyphicon glyphicon-chevron-down"></span>&nbsp;&nbsp;Exploit Connection Details
                </a>
            </h4>
        </div>
        <div id="collapseOne" class="panel-collapse collapse in">
            <div class="panel-body">

	{% if exploit %}

<div class="table-responsive">
	<table class="table table-condensed table-hover">
		<tr>
			<td>Source IP</td><td>{{ exploit.attacker.attacker_ip }}</td>
		</tr>
		<tr>
			<td>Source Port</td><td>{{ exploit.attacker.attacker_port }}</td>
		</tr>
		<tr>
			<td>Destination Port</td><td>{{ exploit.attacker.victim_port }}</td>
		</tr>
		<tr>
			<td>Vulnerability Name</td><td>{{ exploit.vulnerability_name }}</td>
		</tr>
		<tr>
			<td>Download Method</td><td>{{ exploit.download_method }}</td>
		</tr>
		<tr>
			<td>Shellcode Name</td><td>{{ exploit.shellcode_name }}</td>
		</tr>
		<tr>
			<td>Exploit Attempts</td><td>{{ exploit.count }}</td>
		</tr>
		<tr>
			<td>First Seen</td><td>{{ exploit.first_seen }}</td>
		</tr>
		<tr>
			<td>Last Seen</td><td>{{ exploit.last_seen }}</td>
		</tr>
	</table>
</div>
</div></div></div>

{% if submissions %}
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">
				<a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
					<span class="glyphicon glyphicon-chevron-down"></span>&nbsp;&nbsp;Submission from this attacker
				</a>
			</h4>
		</div>
		<div id="collapseTwo" class="panel-collapse collapse">
			<div class="panel-body">
				<div class="table-responsive">
					<table class="table table-condensed table-hover">
						<tr>
							<th>Attacker IP</th>
							<th>File Hash</th>
							<th>Last Seen</th>
							<th>Submissions</th>
							<th>Options</th>
						</tr>
						{% for submission in submissions %}
							<tr>
								<td>{{ submission.exploit.attacker.attacker_ip }}</td>
								<td>{{ submission.md5_hash }}</td>
								<td>{{ submission.last_seen }}</td>
								<td>{{ submission.count }}</td>
								<td><a href="{% url 'submission_details' submission_id=submission.id %}"><span class="glyphicon glyphicon-search"></span></a></td>
							</tr>
						{% endfor %}
					</table>
				</div>
			</div>
		</div>
	</div>
{% endif %}


	{% else %}

	No such exploit entry exists.
	</div></div></div>

	{% endif %}


{% endblock %}
