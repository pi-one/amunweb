{% extends "base.html" %}

{% block content %}

	<h3>Successful Exploits</h3>

	<div class="pagination">
		<span class="step-links">
			{% if exploits.has_previous %}
				<a href="?page={{ exploits.previous_page_number }}">previous</a>
			{% endif %}
			<span class="current">
				Page {{ exploits.number }} of {{ exploits.paginator.num_pages }}.
			</span>
			{% if exploits.has_next %}
				<a href="?page={{ exploits.next_page_number }}">next</a>
			{% endif %}
		</span>
	</div>

	<div class="table-responsive">
		<table class="table table-condensed table-hover">
			<tr>
				<th>Attacker IP</th>
				<th>Destination Port</th>
				<th>Vulnerability</th>
				<th>Last Seen</th>
				<th>Exploits</th>
				<th>Options</th>
			</tr>
			{% for expl in exploits%}
			<tr>
				<td>{{ expl.attacker.attacker_ip }}</td>
				<td>{{ expl.attacker.victim_port }}</td>
				<td>{{ expl.vulnerability_name }}</td>
				<td>{{ expl.last_seen }}</td>
				<td>{{ expl.count }}</td>
				<td><a href="{% url 'exploit_details' exploit_id=expl.id %}"><span class="glyphicon glyphicon-search"></span></a></td>
			</tr>
			{% endfor%}
		</table>
	</div>

	<div class="pagination">
		<span class="step-links">
			{% if exploits.has_previous %}
				<a href="?page={{ exploits.previous_page_number }}">previous</a>
			{% endif %}
			<span class="current">
				Page {{ exploits.number }} of {{ exploits.paginator.num_pages }}.
			</span>
			{% if exploits.has_next %}
				<a href="?page={{ exploits.next_page_number }}">next</a>
			{% endif %}
		</span>
	</div>

{% endblock %}
